# Morse-Code-Messenger(LabVIEWxPIC)
PC（LabVIEW）に入力したテキストを、リアルタイムで**光と音のモールス信号**に変換して出力する組み込みシステムです。  

[![C Language](https://img.shields.io/badge/Language-C-blue?style=for-the-badge&logo=c&logoColor=white)](https://ja.wikipedia.org/wiki/C%E8%A8%80%E8%AA%9E)
[![LabVIEW](https://img.shields.io/badge/Tools-LabVIEW-orange?style=for-the-badge&logo=ni&logoColor=white)](https://www.ni.com/ja-jp/shop/labview.html)
[![Microchip](https://img.shields.io/badge/Hardware-PIC16F819-red?style=for-the-badge&logo=microchip&logoColor=white)](https://www.microchip.com/)

## 🎓 学習目的

LabVIEWとPICマイコンを用いた「ソフトウェアとハードウェアの連携」の理解を深めることを目的としています。
このプロジェクトを通して、以下の学習をしました。

- **シリアル通信 (UART/RS232):** PCとマイコン間でのデータ送受信の仕組み
- **ハードウェア制御:** GPIO操作（LED点灯）およびPWM的な周波数生成（スピーカー発音）
- **アルゴリズム実装:** 文字（ASCII）をモールス信号パターンへ変換するロジックの構築
- **システム統合:** GUIアプリケーション（LabVIEW）と組み込みC言語の統合開発
- **割り込み・ポーリング:** `kbhit()` を用いたデータ受信待ち受け処理の実装

---

## 🚀 主な機能

- **テキスト送信:** PC上のGUIから任意の文字列（アルファベット・数字）を入力・送信
- **自動翻訳:** PICマイコン内で文字を解析し、対応するモールス信号へ自動変換
- **光と音の出力:** LEDの点滅とスピーカーのブザー音（1kHz）による同期出力
- **エコーバック:** 通信信頼性を確認するため、受信データをPCへ返送する機能

---

## 🔌 配線・接続 (Hardware Setup)

PIC16F819 (18-pin DIP) を使用した詳細な配線表です。  
ブレッドボード上で組む際は、電源ラインのショートに十分注意してください。

| PIC Pin No. | ピン名称 | 機能 | 接続先・詳細 |
| :---: | :--- | :--- | :--- |
| **1** | RA2 / AN2 | **RX (受信)** | USB-シリアル変換モジュールの **TX** へ接続<br>*(※クロス接続になります)* |
| **2** | RA3 / AN3 | (未使用) | 未接続 (Open) |
| **3** | RA4 / T0CKI | **TX (送信)** | USB-シリアル変換モジュールの **RX** へ接続<br>*(※クロス接続になります)* |
| **4** | RA5 / MCLR | Reset | 未接続 (内部設定で無効化済み) |
| **5** | **VSS** | **GND** | **電源のGND (マイナス)**<br>*(※USBモジュールのGNDとも必ず接続すること)* |
| **6 - 7** | RB0 - RB1 | (未使用) | 未接続 |
| **8** | **RB2** | **LED出力** | **LEDのアノード(+)** へ接続<br>*(※必ず330Ω程度の抵抗を直列に入れる)* |
| **9** | **RB3** | **SPK出力** | **圧電スピーカーのプラス** へ接続<br>*(※マイナス側はGNDへ)* |
| **10 - 13** | RB4 - RB7 | (未使用) | 未接続 |
| **14** | **VDD** | **VCC** | **電源の+5V (プラス)** |
| **15 - 18** | RA6 - RA1 | (未使用) | 未接続 |

> **⚠️ 注意事項:**
> * LEDには必ず**電流制限抵抗（330Ω〜1kΩ）**を使用してください。直結すると破損の原因になります。
> * USBシリアル変換モジュールの電圧設定が **5V** または **3.3V** であることを確認してください（PIC16F819は通常5V駆動推奨）。

---

## 🛠️ セットアップ手順 (Installation)

このプロジェクトを再現・実行するための手順です。

### 1. 必要なもの
* **ハードウェア:**
    * PIC16F819 マイコン
    * USB-シリアル変換モジュール (FT232など)
    * LED x1, 抵抗 (330Ω) x1, 圧電スピーカー x1
    * PIC書き込み器 (PICKit 3/4など)
* **ソフトウェア:**
    * Cコンパイラ: CCS C Compiler (または MPLAB XC8 ※要コード修正)
    * LabVIEW (NI VISAドライバインストール済み)

### 2. PICへの書き込み (Firmware)
1. リポジトリ内の `819-ReadSonar.c` をメインファイルとしてプロジェクトを開きます。
2. コンパイルを実行し、HEXファイルを生成します。
3. PIC書き込み器を使用して、HEXファイルをPIC16F819に書き込みます。

### 3. ハードウェアの接続
1. 上記の「配線・接続」表に従って回路を配線します。
2. USB-シリアル変換モジュールをPCに接続します。
3. デバイスマネージャーを開き、割り当てられた **COMポート番号** (例: `COM3`) を確認します。

### 4. LabVIEWの実行 (Software)
1. LabVIEWプロジェクトファイル (`.vi`) を開きます。
2. フロントパネルの「VISA Resource Name」で、先ほど確認した **COMポート** を選択します。
3. **実行ボタン (矢印)** をクリックします。
4. テキストボックスに `SOS` などの文字を入力し、送信します。
5. 回路側のLEDとスピーカーが反応すれば成功です！🎉

---

## 🛠 使用技術

| 分野 | 技術・ツール |
| :--- | :--- |
| **ハードウェア (MCU)** | Microchip PIC16F819 |
| **ソフトウェア (Embedded)** | C言語 (CCS C Compiler) |
| **ソフトウェア (Client)** | LabVIEW (GUI, VISA通信) |
| **通信プロトコル** | UART (9600bps, 8bit, Parity: None) |
| **出力デバイス** | LED, 圧電スピーカー |

---

## 🔮 今後の実装予定・改善点

- **速度調整機能の実装**
    - 現在は固定されているモールス信号の再生速度（WPM）を、LabVIEW側から可変できるように改良する予定です。
- **受信デコード機能**
    - タクトスイッチなどを追加し、逆に「モールス信号を入力してPCに文字を表示する」双方向通信システムへの拡張を検討しています。
- **コードのリファクタリング**
    - 現在のポーリング方式から、割り込み処理（Interrupt）を用いたより効率的な受信フローへの書き換えを予定しています。
